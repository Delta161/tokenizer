---
applyTo: 'backend/src/modules/accounts/types/kyc.types.ts'
---

# `kyc.types.ts` — Development & Usage Guidelines

This document provides detailed guidelines for the **`kyc.types.ts`** file located at:

```
backend/src/modules/accounts/types/kyc.types.ts
```

---

## Purpose

The `kyc.types.ts` file defines TypeScript enums, interfaces, and DTOs related to the Know Your Customer (KYC) domain in the accounts module. These types represent KYC statuses, submission data, provider sessions, update payloads, and structured responses for KYC operations.

---

## Best Practices

* **Domain Focus:** Contain only KYC-related types such as status enums, submission data, update payloads, and provider sessions.
* **Reuse Prisma Types:** Import Prisma-generated types (`KycRecord`, `User`) where applicable to keep consistency between your database schema and application logic.
* **Explicit Status Enum:** Use a dedicated `KycStatus` enum for all possible KYC states to enforce strict typing and avoid magic strings.
* **Strong Typing of Responses:** Provide typed response interfaces for KYC data operations, including success flags and optional error messages.
* **Separate DTOs:** Distinguish between data transfer objects (`KycRecordDTO`, `KycRecordWithUser`) and raw Prisma types for flexibility and control.
* **Provider Flexibility:** Define an enum for supported KYC providers to standardize provider references.
* **Session Typing:** Provide a clear interface for KYC provider session info, including expiry and redirect details.
* **Minimal Update Payload:** Limit admin update payloads to necessary fields (`status`, `rejectionReason`) to avoid accidental data corruption.

---

## Core Types and Interfaces

### `KycStatus`

* Enumerates all allowed KYC states: NOT\_SUBMITTED, PENDING, VERIFIED, REJECTED.
* Use this enum across services, middleware, and APIs to ensure consistency.

### `KycRecordDTO`

* Represents the shape of a KYC record used in data transfer layers.
* Contains key fields such as `id`, `userId`, `status`, `documentType`, and timestamps.
* Includes optional fields for provider data and rejection reasons.

### `KycProvider`

* Enumerates all supported external KYC providers (e.g., Sumsub, Onfido, Veriff).
* Use in service integration logic and when specifying or switching providers.

### `KycProviderSession`

* Represents a session object returned by KYC providers when initiating verification.
* Includes redirect URL, session expiration, and provider reference ID.

### `KycSubmissionData`

* Interface for data submitted by users when providing KYC information.
* Keeps submission payload minimal, focusing on required fields like document type and country.

### `KycUpdateData`

* Represents admin-only update data for KYC status changes.
* Includes status and optional rejection reason.

### `KycRecordWithUser`

* Extends the raw `KycRecord` with embedded minimal user info (`id`, `email`, `fullName`).
* Useful for admin dashboards and reports combining user and KYC data.

### `KycResponse` & `KycListResponse`

* Standardized API response shapes for single KYC record and list responses.
* Include success status, optional data payload, and error messages for robust API client handling.

---

## Usage Guidelines

* **Import as Types Only:** Use `import type` for these interfaces to avoid runtime side effects.
* **DTO Validation:** Combine these static types with runtime validation (e.g., using Zod) to enforce data integrity.
* **Use Enums Everywhere:** Refer to `KycStatus` and `KycProvider` enums throughout your KYC business logic for type safety.
* **Response Shaping:** Use `KycResponse` and `KycListResponse` for consistent API responses from controllers.
* **Service Layer Contracts:** Use these types as method input/output contracts in your KYC service for clear API boundaries.
* **Avoid Overexposure:** Do not expose raw Prisma models directly in API responses; map them to DTOs.

---

## Security Considerations

* **Data Minimization:** Avoid including sensitive user or document data beyond what’s necessary in DTOs.
* **Error Disclosure:** Carefully handle error messages in response types to prevent leaking internal details.
* **Enum Safety:** Restrict status updates and provider references strictly to defined enums to avoid invalid state transitions.

---

## What Not To Do

* Do not add business logic or functions in this file; keep it purely for type definitions.
* Avoid mixing unrelated domains (e.g., auth or user types) in this file.
* Do not duplicate types already generated by Prisma unless extending or reshaping.
* Avoid overloading response types with too many optional fields.

---

## Future Improvements

* Add types for new providers or support dynamic provider registration.
* Introduce discriminated unions if KYC submission types vary significantly by provider.
* Create utility type guards to detect status or provider types at runtime.
* Support paginated response types for KYC record listings with metadata.

---

## Summary

The `kyc.types.ts` file is the definitive source of truth for all KYC-related type definitions in the accounts module. Maintaining strict typing, clear domain focus, and well-structured response interfaces ensures consistent, maintainable, and type-safe KYC business logic throughout your backend.

---